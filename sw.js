importScripts("js/idb.js"),importScripts("js/dbhelper.js");var cacheName="Cache-v-8";function createDB_Restaurants(){return idb.open("restaurants",1,function(e){e.createObjectStore("details",{keyPath:"id"})}).then(function(e){DBHelper.fetchRestaurants((t,i)=>{if(!t){var s=e.transaction("details","readwrite"),n=s.objectStore("details"),a=i;return Promise.all(a.map(function(e){return n.put(e)})).catch(function(e){s.abort(),console.log(e)}).then(function(){})}console.log(t)})})}function createDB_Reviews(){return idb.open("reviews",1,function(e){e.createObjectStore("details",{keyPath:"id",autoIncrement:!0})}).then(function(e){DBHelper.fetchReviews((t,i)=>{if(!t){var s=e.transaction("details","readwrite"),n=s.objectStore("details"),a=i;return Promise.all(a.map(function(e){return console.log("Db reviews "+e),n.add(e)})).catch(function(e){s.abort(),console.log(e)}).then(function(){})}console.log(t)})})}self.addEventListener("install",function(e){e.waitUntil(caches.open(cacheName).then(function(e){return e.addAll(["index.html","css/i_desktop.css","css/i_mobile.css","css/i_tablet.css","css/r_desktop.css","css/r_mobile.css","css/r_tablet.css","restaurant.html","img/logo-large.jpg","img/logo-small.jpg","manifest.json","img/1-320_small.jpg","img/1-640_medium.jpg","img/2-800_large.jpg","img/2-320_small.jpg","img/2-640_medium.jpg","img/2-800_large.jpg","img/3-320_small.jpg","img/3-640_medium.jpg","img/3-800_large.jpg","img/4-320_small.jpg","img/4-640_medium.jpg","img/4-800_large.jpg","img/5-320_small.jpg","img/5-640_medium.jpg","img/5-800_large.jpg","img/6-320_small.jpg","img/6-640_medium.jpg","img/6-800_large.jpg","img/7-320_small.jpg","img/7-640_medium.jpg","img/7-800_large.jpg","img/8-320_small.jpg","img/8-640_medium.jpg","img/8-800_large.jpg","img/9-320_small.jpg","img/9-640_medium.jpg","img/9-800_large.jpg","img/10-320_small.jpg","img/10-640_medium.jpg","img/10-800_large.jpg","js/dbhelper.js","js/idb.js","js/main.js","js/restaurant_info.js"])}).then(function(){console.log(7)}).catch(function(e){console.log(e)}))}),self.addEventListener("activate",function(e){createDB_Restaurants(),createDB_Reviews()}),self.addEventListener("fetch",function(e){if(e.request.url.includes("restaurant.html?id=")){const t=e.request.url.split("?")[0];e.respondWith(caches.match(t).then(function(t){return t||fetch(e.request)}))}else e.respondWith(caches.match(e.request).then(function(t){return t||fetch(e.request)}))});